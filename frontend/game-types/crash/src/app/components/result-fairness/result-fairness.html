<div
  class="modal bg-black/90 fixed top-0 left-0 w-full h-full flex items-start justify-center p-4 xl:p-10"
  aria-label="Modal container">
  <div class="w-full max-w-4xl h-full max-h-full flex flex-col panel-gradient-bg border-2 border-[#222222] rounded-2xl animated-modal"
  role="main">

    <header class="modal-header shrink-0" aria-label="Modal header" role="heading">
      <div class="modal-title py-4 px-4 xl:px-8 xl:text-lg border-b border-1 border-white/10 flex items-center justify-between relative">
      
        <ng-container *ngIf="vm$ | async as vm">
          <!-- Show content -->
          <div *ngIf="!vm.loading && !vm.error" class="title text-white uppercase flex flex-wrap gap-x-2">
            <span>
              {{ 'fairness-modal.round' | translate }}
              {{ fromHistoryDetails ? vm.roundDetails?.id?.slice(0, 8) : selectedRound?.id.slice(0, 8) }}
            </span>
            <div class="tabular-nums inline-flex font-bold px-2 rounded-md">
              {{ fromHistoryDetails ? vm.roundDetails?.crash : selectedRound?.crash }}x
            </div>
            <span class="w-full sm:w-auto">
              {{ fromHistoryDetails ? (vm.roundDetails?.createdAt | date:'medium') : (selectedRound?.createdAt | date:'medium') }}
            </span>
          </div>
        </ng-container>
        
        <!-- Close button -->
        <div (click)="closeModal()"
          class="btn close-modal text-4xl cursor-pointer absolute right-4 xl:right-8 text-white/50 hover:text-white transition-colors"
          aria-label="Close modal">
          &times;
        </div>
      </div>
    </header>
      
    <section  class="modal-content flex-1 overflow-y-auto py-4 px-4 xl:py-4 xl:px-6 text-[color:#b0b0b0]"
    aria-label="Modal content">

      <div *ngIf="vm$ | async as vm">
        <!-- Loader -->
        <div *ngIf="vm.loading" class="flex justify-center items-center h-full">
          <span class="ml-2 text-white">{{ 'history-popup.loading' | translate }}...</span>
        </div>

        <!-- Error -->
        <div *ngIf="!vm.loading && vm.error" class="text-red-500 text-center">
          {{'error' | translate }}
        </div>

        <div  *ngIf="!vm.loading && !vm.error && (vm.roundDetails || selectedRound)"
          class="grid divide-y divide-white/10 grid-cols-1 text-left justify-between items-stretch text-xs md:text-sm"
          role="contentinfo">
          <div class="flex flex-col gap-6 tabular-nums">
            <div class="flex flex-col gap-4">
              <div class="top px-8 flex items-center gap-4">
                <img src="assets/icons/server-icon.png" alt="" class="w-9 xl:w-11" />
                <div class="flex flex-col">
                  <div class="font-bold text-white">{{ 'fairness-modal.server-seed' | translate }}:</div>
                  <div class="text-white/50">{{ 'fairness-modal.created-by-us' | translate }}</div>
                </div>
              </div>
              <div class="bg-black flex items-center rounded-md px-8 py-2 text-white relative">
                <p class="block w-full text-ellipsis overflow-hidden ">{{fromHistoryDetails ? vm.roundDetails?.serverSeed : selectedRound.serverSeed}}</p>
                <div class="btn copy-button bg-[#222] p-2 cursor-pointer rounded hover:opacity-80 relative"
                  (click)="handleCopy(fromHistoryDetails ? vm.roundDetails?.serverSeed : selectedRound.serverSeed, 'server')">
                  <div *ngIf="copiedId === 'server'"
                    class="absolute -top-9 right-0 text-[10px] px-2 py-1 rounded bg-[#333]">
                    {{ 'copied' | translate }}!
                  </div>
                  <img src="assets/icons/copy.png" class="w-3" alt="">
                </div>
              </div>
            </div>

            <div class="flex flex-col gap-4">
              <div class="top px-8 flex items-center gap-4">
                <img src="assets/icons/laptop.png" alt="" class="w-9 xl:w-11" />
                <div class="flex flex-col">
                  <div class="font-bold text-white">{{ 'fairness-modal.client-seed' | translate }}:</div>
                  <div class="text-white/50">{{ 'fairness-modal.created-by-player' | translate }}</div>
                </div>
              </div>
              <div class="bg-black flex flex-col gap-8 items-start rounded-md px-8 py-6 text-white relative">
                <div *ngFor="let player of fromHistoryDetails ? vm.roundDetails?.clientSeeds : selectedRound.clientSeeds; let i = index"
                    class="flex flex-wrap sm:flex-nowrap gap-x-4 gap-y-4 sm:gap-x-8 sm:gap-y-6 items-center justify-start w-full">
                  <div class=" text-white/50">
                    {{ 'fairness-modal.player' | translate }} #{{ i + 1 }}
                  </div>
                  <div class="size-6 sm:size-8 rounded-full overflow-hidden">
                    <img [src]="randomClientAvatars[i]" class="w-full h-full object-cover" alt="">
                  </div>
                  <div class=" text-white/50">
                    {{ player.username }}
                  </div>
                  <div class="text-left  text-white/50 flex items-center gap-2">
                    {{ 'fairness-modal.seed' | translate }}: <p
                      class="text-white inline-block overflow-hidden text-ellipsis whitespace-nowrap max-w-[25ch] sm:max-w-[16ch] md:max-w-[40ch] lg:max-w-[50ch]">
                      {{ player.seed }}</p>
                  </div>
                </div>
              </div>
            </div>

            <div class="flex flex-col gap-4">
              <div class="top px-8 flex items-center gap-4">
                <img src="assets/icons/lock.png" alt="" class="w-9 xl:w-11" />
                <div class="flex flex-col">
                  <div class="font-bold text-white">{{ 'fairness-modal.combined-sha512' | translate }}:</div>
                  <div class="text-white/50">{{ 'fairness-modal.combined-msg' | translate }}</div>
                </div>
              </div>
              <div class="bg-black flex items-center rounded-md px-8 py-2 text-white relative">
                <p class="block w-full text-ellipsis overflow-hidden">{{fromHistoryDetails ? vm.roundDetails?.combinedHash : selectedRound.combinedHash}}</p>
                <div class="btn copy-button bg-[#222] cursor-pointer rounded hover:opacity-80 px-2 py-2 relative"
                  (click)="handleCopy(fromHistoryDetails ? vm.roundDetails?.combinedHash : selectedRound.combinedHash, 'hash')">
                  <div *ngIf="copiedId ==='hash'" class="absolute -top-9 right-0 text-[10px] px-2 py-1 rounded bg-[#333]">
                    {{ 'copied' | translate }}!
                  </div>
                  <img src="assets/icons/copy.png" class="w-3" alt="">
                </div>
              </div>
              <!-- <div
                    class=" grid grid-cols-3 justify-center  text-center rounded-md  text-white/50 relative"
                  >
                    <span>Sixteen</span>      
                    <span>Ten</span>  
                    <span>Result</span>          
                  </div>
                  <div
                    class="bg-black grid grid-cols-3 justify-center gap-8 text-center rounded-md px-8 py-4 text-white relative"
                  >
                    <span>24a9e1cb8f1bb</span>      
                    <span>644992900592059</span>  
                    <span>18.39</span>          
                  </div> -->

              <div class="bg-black flex items-center rounded-md px-8 py-4 relative">
                <span class=" text-white/50 ">{{ 'fairness-modal.result' | translate }}: <span
                    class=" text-white ">{{fromHistoryDetails ? vm.roundDetails?.crash : selectedRound.crash}}x</span></span>
              </div>
            </div>

          </div>
        </div>
      </div>
    </section>
  </div>
</div>